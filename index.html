<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Google Charts Jquery</title>
<meta content='width=device-width, initial-scale=1' name='viewport'/>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js" type="text/javascript"></script>
<script src="ajaxGetPost.js" type="text/javascript"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script>

var data;
var options,options2;
var chart1, chart2,chart3,chart4;
var jsonData;

function charts(data_in,ChartType)
{

	var c=ChartType;
	jsonData=data_in;
	google.load("visualization", "1", {packages:["corechart"], callback: drawVisualization});
	
	function drawVisualization() 
	{
	data = new google.visualization.DataTable();
	data.addColumn('string', 'Especilitat');
	data.addColumn('number', 'Estudiants');
	$.each(jsonData.results, function(i,valor)
		{
		var num_estudiants=valor.num_estudiants;
		var nom_modul=valor.nom_modul;
		data.addRows([ [nom_modul, num_estudiants]]);
		});

	if(c=="DonutChart")  {
	   options2 = {
			title : "Alumnes per especialitat curs 2016-2017 (2)",
			colorAxis: {colors: ['#54C492', '#cc0000']},
			datalessRegionColor: '#dedede',
			defaultColor: '#dedede',
	        pieHole: 0.4,
			animation:{
				duration: 3000,
				easing: 'out'
			},
	    };
	}
	else
	{
		options = {
		title : "Alumnes per especialitat curs 2016-2017 (2)",
		colorAxis: {colors: ['#54C492', '#cc0000']},
		datalessRegionColor: '#dedede',
		defaultColor: '#dedede',
		animation:{
        duration: 3000,
        easing: 'out'
      },

		};
	}

	
	if(c=="ColumnChart"){
		chart1 = new google.visualization.ColumnChart(document.getElementById('chart_div'));
		chart1.draw(data, options);
	}
	else if(c=="PieChart") {
		chart2 = new google.visualization.PieChart(document.getElementById('piechart_div'));
		chart2.draw(data, options);
	}
	else if(c=="BarChart") {
		chart3 = new google.visualization.BarChart(document.getElementById('bar_div'));
		chart3.draw(data, options);
	}
	else if(c=="DonutChart") {
		chart4 = new google.visualization.PieChart(document.getElementById('donut_div'));
		chart4.draw(data, options2);
	}	

	
	}
	
}

 function apretaBoto()  {
		var triada = document.getElementById('sexe')
		
		$.each(jsonData.results, function(i,valor)
		{
			if (sexe.value=='Tots')
				data.setValue(i,1,valor.num_estudiants);
			else if (sexe.value=='Homes')	
				data.setValue(i,1,valor.num_homes);
			else if (sexe.value=='Dones')	
			{
				data.setValue(i,1,valor.num_dones);
			}
		});
		
		chart1.draw(data, options);
		chart2.draw(data, options);
		chart3.draw(data, options);
		chart4.draw(data, options2);
    }
	


	
$(document).ready(function () 
{
url='especialitats.json';
ajax_data('GET',url, function(data)
		{
			charts(data,"ColumnChart");	
			charts(data,"PieChart");	
			charts(data,"DonutChart");	
			charts(data,"BarChart");
		});
});
</script>

<style>
body{font-family:arial}
</style>
</head>
<body style="text-align:center">
<h1>Indicadors d'Especialitat de la FIB</h1>

 
   Sexe: <select id="sexe" onchange="apretaBoto()">
	<option value="Tots">Tots</option>
	<option value="Homes">Homes</option>
	<option value="Dones">Dones</option>
	</select> 
	</input> 
	
<div id="chart_div"></div>

<table>
<TR><TD><div id="donut_div" style="width: 700px; height: 250px;"></div></TD>
	<TD><div id="piechart_div" style="width: 700px; height: 250px;"></div></TD>
</TR>
</TABLE>
<div id="bar_div" style="width: 900px; height: 500px;"></div>
	

 




</body>
</html>